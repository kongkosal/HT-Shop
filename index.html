<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HT SHOP</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f9f9f9;
    }
    header {
      background-color: #000000;
      color: white;
      padding: 20px;
      text-align: center;
    }
    nav {
      background: #e0e0e0;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      padding: 10px;
    }
    nav a {
      margin: 0 10px;
      text-decoration: none;
      color: #000;
      font-weight: bold;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px;
    }
    .product {
      background: white;
      border: 1px solid #ccc;
      margin: 10px;
      padding: 10px;
      width: 220px;
      text-align: center;
      border-radius: 8px;
      box-sizing: border-box;
      transition: transform 0.3s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .product:hover {
      transform: scale(1.05);
    }
    .product img {
      width: 100%;
      height: auto;
      border-radius: 5px;
    }
    .price {
      margin: 5px 0;
    }
    .old-price {
      text-decoration: line-through;
      color: #888;
      margin-right: 8px;
    }
    .new-price {
      color: green;
      font-weight: bold;
    }
    button {
      background-color: orange;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: darkorange;
    }
    h2 {
      font-size: 18px;
      margin: 10px 0;
    }
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
      padding: 20px;
      box-sizing: border-box;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 8px;
      width: 100%;
      max-width: 320px;
      text-align: center;
      animation: fadeIn 0.3s ease;
    }
    .quantity {
      margin: 15px 0;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
    }
    .quantity button {
      width: 40px;
      height: 40px;
      font-size: 20px;
      padding: 0;
    }
    .close-btn {
      margin-top: 10px;
      background-color: #999;
    }
    .checkout-btn {
      background-color: green;
      margin-top: 10px;
    }
    #login-form, #register-form {
      max-width: 320px;
      margin: 50px auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      display: none;
      flex-direction: column;
      gap: 10px;
    }
    #login-form.active, #register-form.active {
      display: flex;
    }
    input[type="text"], input[type="password"] {
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
      width: 100%;
      box-sizing: border-box;
    }
    #bill-history {
      max-width: 800px;
      margin: 30px auto 50px auto;
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      display: none;
    }
    #bill-history h2 {
      text-align: center;
      margin-bottom: 15px;
    }
    #bill-table {
      width: 100%;
      border-collapse: collapse;
    }
    #bill-table th, #bill-table td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    #bill-table th {
      background: #f0f0f0;
    }
    #logout-btn {
      max-width: 320px;
      margin: 20px auto;
      display: none;
      text-align: center;
    }
    #logout-btn button {
      background-color: #555;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }
    #logout-btn button:hover {
      background-color: #333;
    }
    @keyframes fadeIn {
      from {
        transform: translateY(20px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    @media (max-width: 600px) {
      .container {
        flex-wrap: wrap;
        justify-content: flex-start;
        padding: 10px;
        gap: 10px;
      }
      .product {
        width: calc(50% - 10px);
        margin: 0;
        margin-bottom: 15px;
      }
      h2 {
        font-size: 16px;
      }
      button {
        padding: 14px;
        font-size: 16px;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>HT SHOP</h1>
</header>

<!-- Login Form -->
<div id="login-form" class="active">
  <h2>Login</h2>
  <input type="text" id="login-username" placeholder="Username" />
  <input type="password" id="login-password" placeholder="Password" />
  <button onclick="login()">Login</button>
  <p>Don't have an account? <a href="#" onclick="showRegister()">Register here</a></p>
</div>

<!-- Register Form -->
<div id="register-form">
  <h2>Register</h2>
  <input type="text" id="register-username" placeholder="Username" />
  <input type="password" id="register-password" placeholder="Password" />
  <button onclick="register()">Register</button>
  <p>Already have an account? <a href="#" onclick="showLogin()">Login here</a></p>
</div>

<!-- Main Content -->
<div id="main-content" style="display:none;">
  <nav>
    <a href="#" onclick="logout()">Logout (<span id="user-display"></span>)</a>
  </nav>

  <div class="container">
  <div class="product">
    <img src="image.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image1.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image2.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image3.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image4.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image5.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image6.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image7.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image8.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image9.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image10.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image11.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image12.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image13.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image14.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image15.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image16.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image17.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image18.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image19.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
  </div>

  <div class="product">
    <img src="image20.jpg" alt="Segar 15000 Puff" />
    <h2>Segar 15000 Puff</h2>
    <p class="price"><span class="old-price">$7</span> <span class="new-price">$5</span></p>
    <button onclick="openModal('Segar 15000 Puff', 5)">Order</button>
 </div>
</div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <h2 id="modal-name">Product Name</h2>
      <p>Price: $<span id="modal-price">0.00</span></p>
      <div class="quantity">
        <button onclick="changeQuantity(-1)">-</button>
        <span id="modal-quantity">1</span>
        <button onclick="changeQuantity(1)">+</button>
      </div>
      <p>Total: $<span id="modal-total">0.00</span></p>
      <button class="checkout-btn" onclick="checkout()">Checkout</button>
      <button class="close-btn" onclick="closeModal()">Close</button>
    </div>
  </div>

  <!-- Bill History -->
  <div id="bill-history">
    <h2>Bill History</h2>
    <table id="bill-table">
      <thead>
        <tr>
          <th>Bill No</th>
          <th>Product</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody id="bill-body">
        <!-- Bills inserted here -->
      </tbody>
    </table>
  </div>
</div>

<script>
  let currentQuantity = 1;
  let currentProduct = '';
  let currentPrice = 0;

  // Users stored as { username: password }
  let users = JSON.parse(localStorage.getItem('users')) || {};

  // Bill counter and history
  let billCounter = parseInt(localStorage.getItem('billCounter')) || 1000;
  let billHistory = JSON.parse(localStorage.getItem('billHistory')) || [];

  // Check if logged in
  function checkLogin() {
    const loggedInUser = localStorage.getItem('loggedInUser');
    if (loggedInUser) {
      document.getElementById('login-form').classList.remove('active');
      document.getElementById('register-form').classList.remove('active');
      document.getElementById('main-content').style.display = 'block';
      document.getElementById('user-display').innerText = loggedInUser;
      document.getElementById('bill-history').style.display = 'block';
      displayBillHistory();
    } else {
      document.getElementById('login-form').classList.add('active');
      document.getElementById('register-form').classList.remove('active');
      document.getElementById('main-content').style.display = 'none';
    }
  }

  function showRegister() {
    document.getElementById('login-form').classList.remove('active');
    document.getElementById('register-form').classList.add('active');
  }
  function showLogin() {
    document.getElementById('register-form').classList.remove('active');
    document.getElementById('login-form').classList.add('active');
  }

  function login() {
    const username = document.getElementById('login-username').value.trim();
    const password = document.getElementById('login-password').value.trim();

    if (!username || !password) {
      alert('Please enter username and password.');
      return;
    }

    if (users[username] && users[username] === password) {
      localStorage.setItem('loggedInUser', username);
      alert(`Welcome back, ${username}!`);
      clearLoginFields();
      checkLogin();
    } else {
      alert('Invalid username or password.');
    }
  }

  function register() {
    const username = document.getElementById('register-username').value.trim();
    const password = document.getElementById('register-password').value.trim();

    if (!username || !password) {
      alert('Please enter username and password.');
      return;
    }
    if (users[username]) {
      alert('Username already exists.');
      return;
    }
    users[username] = password;
    localStorage.setItem('users', JSON.stringify(users));
    alert('Registration successful! Please login.');
    clearRegisterFields();
    showLogin();
  }

  function logout() {
    localStorage.removeItem('loggedInUser');
    alert('You have logged out.');
    checkLogin();
  }

  function clearLoginFields() {
    document.getElementById('login-username').value = '';
    document.getElementById('login-password').value = '';
  }
  function clearRegisterFields() {
    document.getElementById('register-username').value = '';
    document.getElementById('register-password').value = '';
  }

  function openModal(name, price) {
    currentProduct = name;
    currentPrice = price;
    currentQuantity = 1;
    document.getElementById('modal-name').innerText = name;
    document.getElementById('modal-price').innerText = price.toFixed(2);
    document.getElementById('modal-quantity').innerText = currentQuantity;
    document.getElementById('modal-total').innerText = (price * currentQuantity).toFixed(2);
    document.getElementById('modal').style.display = 'flex';
  }

  function closeModal() {
    document.getElementById('modal').style.display = 'none';
  }

  function changeQuantity(amount) {
    currentQuantity += amount;
    if (currentQuantity < 1) currentQuantity = 1;
    document.getElementById('modal-quantity').innerText = currentQuantity;
    document.getElementById('modal-total').innerText = (currentPrice * currentQuantity).toFixed(2);
  }

  function saveBill(bill) {
    billHistory.push(bill);
    localStorage.setItem('billHistory', JSON.stringify(billHistory));
  }

  function displayBillHistory() {
    const tbody = document.getElementById('bill-body');
    tbody.innerHTML = '';

    const loggedInUser = localStorage.getItem('loggedInUser');
    if (!loggedInUser) return;

    // Filter bills only for logged-in user
    const userBills = billHistory.filter(bill => bill.customerName === loggedInUser);

    userBills.forEach(bill => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${bill.billNumber}</td>
        <td>${bill.productName}</td>
        <td>$${bill.productPrice}</td>
        <td>${bill.quantity}</td>
        <td>$${bill.total}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  function checkout() {
    const loggedInUser = localStorage.getItem('loggedInUser');
    if (!loggedInUser) {
      alert('You must be logged in to checkout!');
      return;
    }

    billCounter++;
    localStorage.setItem('billCounter', billCounter);

    const total = (currentPrice * currentQuantity).toFixed(2);
    const billNumber = `BILL-${billCounter}`;

    const bill = {
      billNumber,
      customerName: loggedInUser,
      productName: currentProduct,
      productPrice: currentPrice.toFixed(2),
      quantity: currentQuantity,
      total
    };

    saveBill(bill);
    displayBillHistory();

    const message =
`🧾 *Order Bill*
*Bill No:* ${bill.billNumber}
*Name:* ${bill.customerName}

*Product:* ${bill.productName}
*Price:* $${bill.productPrice}
*Quantity:* ${bill.quantity}
*Total:* $${bill.total}`;

    const botToken = "7597962374:AAFHkklfpEKWGXzErmnywORTpMRco32uncs";
    const chatId = "1268254469";

    fetch(`https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}&parse_mode=Markdown`)
      .then(res => res.json())
      .then(data => {
        if (data.ok) {
          alert(`✅ Order sent! Bill No: ${bill.billNumber}`);
        } else {
          alert("❌ Failed to send order.");
          console.error(data);
        }
      })
      .catch(error => {
        alert("❌ Error sending order.");
        console.error(error);
      });

    closeModal();
  }

  // Initialize page
  checkLogin();

</script>

</body>
</html>

